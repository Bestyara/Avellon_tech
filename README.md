# Avellon - техническая часть ПО 

![image info](https://github.com/Kostyak7/Avellon_tech/blob/main/resource/img/logo.png)

## Запус и установка

Минимальнаня необходимая версия - `python 3.8`

![image info](https://github.com/Kostyak7/Avellon_tech/blob/main/resource/img/appbat.png)

Пока самые легкие установка и запуск проекта реализованы только для Windows.
Необходимо скачать данный проект, а после из "Проводника" запустить `app.bat`.
В первый раз установка может занять некоторое время. В последствии запускать
программу можно также через 

### Запуск и настройка вручную (через консоль)

Необходимо скачать проект и открыть путь к нему в консоле
```bash
cd C:/Users/.../Avellon_tech
```
Установите виртуальное окружение Python
```bash
python3 -m venv venv
```
Чтобы войти в виртуальное окружение Python на Windows введите
```bash
venv\Scripts\activate.bat
```
На Unix системах (MacOS, Linux) 
(возможно перед этим придеться сделать файл запуска 
виртуального окружения исполняемым через команду `chmod +x venv/bin/activate`)
```bash
./venv/bin/activate
```
После входа у вас перед путем текущей директории должна появиться
приписка `(venv)`

Установите все необходимые пакеты через pip из файла требуемых пакетов 
(Важно, выполняя этот шаг находиться в виртуальном окружении!)
```bash
pip install -r requirements.txt
```
После установки создайте следующие папки в дириктории проекта:
`projects`, `projects/test_1`, `save_data`, `data`.

Для зпуска необходимо через Python запустить `main.py`, это делается следующей командой
```bash
python3 main.py
```
В сдедующие сессии работы с программой установка не требуется, 
а для запуска необходимо войти в виртуальное окружение и также запускать `main.py`  

## Функционал
В настоящий момент реализован следующий функионал:
* Добавление секций в скважину, их настройка (имя, глубина, длина) и удаление. Добавление шагов измерения в каждую секцию. Добавление файлов в каждый шаг.
* Построение Осциллограммы по выбраным файлам.
* Построение Частотный характеристики для всех датчиков во всех шагах, у которых есть 21 файл с данными измерения
* Построение Графика зависимости амплитуды во времени
* Построение Розы ветров по датчикам
* Конвертер файлов

![image info](https://github.com/Kostyak7/Avellon_tech/blob/main/resource/img/main_menu.png)

Скачать тестовые данные можно по [ссылке](https://drive.google.com/file/d/1j_6-RZMyNiTh0wSIMSseCACk957Fua5j/view?usp=sharing).

Чтобы построить любой график необходимо загруить файлы и в окне желаемого графика нажать `▷ Построить`. 

Каждый построенный график можно сохранить. Быстро с помощью пункта `Сохранить` в панеле сверху или сочетания клавиш `Ctrl+S`. 
Тогда файл автоматически сохраниться в папку `save_data` в дириктории проекта проекте.
Более детальное сохранение доступно при нажатии `Сохранить как` - `Ctrl+Shift+S`, тогда откроется диалоговое окно 
и появиться возможность выбрать место и имя сохраняемого файла.

В окне любого графика можно поднастроить скважину для всего проекта. Это делается через верхнюю панель `Скважина->Настроить скважину`.

Для получения справочной информации необходимо нажать на `Справка` на верхней панеле.

При нажатии кнопки `Назад` на верхней панеле пользователь вернется в главное меню.

У каждого графика можно убирать отдельные лини с помощью списка галочек.

### Настройка скважины
Настройка скважины есть единое окружение для постройки любого графика.
Для постройки некоторых из них необходимо определенное количество исходных файлов с данными.

![image info](https://github.com/Kostyak7/Avellon_tech/blob/main/resource/img/section_menu.png)

При открытии экрана настройки скважины изначально будут доступны 3 кнопки:
* `+ Добавить секцию` - при нажатии которой в списке появляется секция с возможностью ее дальнейшего редактирования.
* `Принять` - все внесенные изменения в настройку секции вступят в силу
* `Отмена` -  все внесенные изменения в настройку секции отменяться, скважина вернется в настройку до открытия окна настройки скважины

В соответсутвующий полях секции можно настроить `Имя` секции, `Глубину` ее месторасположения, `Длину`.
С помощью кнопок `+`, `▽`, `Х` можно добавить новый шаг в секцию,
открыть/закрыть список уже существующих шагов, полностью удалить секцию соответсвенно. У каждой секции должно быть свое уникальное имя 
(Написать два одинаковых программа ва не позволит)

Аналогично у шага можно редактировать его номер, добавлять файлы с данными, открывать/закрывать список добавленных файлов,
удалять шаг. Номер уникален для каждого шага. Добавленные файлы должны иметь разное базвое название по формату `DEFAULT_A_0mm_0.csv`,
В противном случае в проекте останется только последний добавленный файл с повторяющимся именем.

Файлы также можно удалять с помощь кнопки `Х`. 

Пока что изменение имени или номера шага соответсвенно для Секции или Шага сотрет все что есть внутри них.

Галочки у каждого раздела означает, необходимо ли учитывать файл в построении осциллограммы.

### Осциллограмма
![image info](https://github.com/Kostyak7/Avellon_tech/blob/main/resource/img/oscilloscope.png)

Если в скважину добавлены файлы, то с помощью кнопки в верхней панеле
можно построить осциллограмму выбранных файлов (поставлена голчка напротив).
Также строиться Таблица максимумов.

### Частотная характеристика
Для построения частотной характеристики для одного датчика необходим 21 файл с данными в одном шаге.

![image info](https://github.com/Kostyak7/Avellon_tech/blob/main/resource/img/frequency.png)

Также в окне доступна возможность настройки визуализации участка скважины с трещинами.
Настройка производиться в окне называемом кнопкой `Задать параметры трубы`. 
В данном окне есть возможность настроить в соответствующих полях `Длину`, `Диаметр внутренности`, `Толщину стенок`,
`Направление прозвучки`, `Имена датчиков`. А также добавить трещены - `+ Добавить`. `Принять` - все внесенные изменения в настройку секции вступят в силу.
`Отмена` -  все внесенные изменения в настройку секция отменяться, все вернется в настройку до открытия окна.

![image info](https://github.com/Kostyak7/Avellon_tech/blob/main/resource/img/crack_menu.png)

У каждой трещины можно настроить `Cторону` ее расположения - Верхняя/Нижняя, `Глубину` трещены, `Позицию` на трубе.

 
### График зависимости амплитуды во времени
![image info](https://github.com/Kostyak7/Avellon_tech/blob/main/resource/img/amplitude.png)

График можно построить для каждого датчика секции по отдельности, он строиться по имеющимся шагам.
То есть для построения необходимо иметь минимум два шага для датчика, заполненные файлами. 

### Роза ветров
![image info](https://github.com/Kostyak7/Avellon_tech/blob/main/resource/img/windrose.png)

Роза ветров строиться по датчикам секции по номерам измерений для абсолютных значений или для относительных.
Чтобы выбрать способ отображение есть галочка `Абсолютное значение`.
С помощью слайдера можно выбирать номер измерения для отображения соответствующей розы.

## Конвертер файлов
![image info](https://github.com/Kostyak7/Avellon_tech/blob/main/resource/img/converter.png)

Конвертер помогает быстро и просто переделывать файлы (поврежденные или имеющие лишние строки данных) под формат тех,
что требует основная программа.

Первые три поля помогают настроить название файлов полученных при конвертировании, чтобы те соответствовали стандартам - DEFAULT_A_0mm_0.csv

Первое поле отвечает за настройку номера датчика, к которому относяться конвертируемые файлы. Оно может принимать значения от A(0) до H(7).

Второе поле ответственно за глубину трещены, отображаемой в названии - неотрицательное целое число.

Третье поле отвечает за то, начиная с какого номера будут отсчитываться номера измерений - неотрицательное целое число.
